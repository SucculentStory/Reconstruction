# Mike Vanderjagt
lines<-"Year,Age,Tm,Pos,No.,G,GS,FGA019,FGM019,FGA20229,FGM2029,FGA3039,FGM3039,FGA4049,FGM4049,FGA50,FGM50,FGAtot,FGMtot,FGper,XPA,XPM,XPper,Pnt,Yds,Lng,Blck,Y/P,AV
1998,28,IND,K,12,14,0,1,1,8,8,4,4,9,8,9,6,31,27,87.1,23,23,100.0,,,,,,0
1999,29,IND,K,12,16,0,2,2,10,10,13,11,11,10,2,1,38,34,89.5,43,43,100.0,,,,,,0
2000,30,IND,K,12,16,0,1,1,6,6,13,13,6,5,1,,27,25,92.6,46,46,100.0,,,,,,0
2001,31,IND,K,13,16,0,,,8,7,6,6,16,12,4,3,34,28,82.4,42,41,97.6,,,,,,0
2002,32,IND,K,13,16,0,1,1,8,7,7,6,12,6,3,3,31,23,74.2,34,34,100.0,,,,,,0
2003*+,33,IND,K,13,16,0,,,17,17,7,7,12,12,1,1,37,37,100.0,46,46,100.0,1,29,29,0,29.0,0
2004,34,IND,K,13,15,0,,,6,6,11,9,7,5,1,,25,20,80.0,60,59,98.3,,,,,,0
2005,35,IND,K,13,16,0,1,1,9,9,7,6,8,7,,,25,23,92.0,52,52,100.0,,,,,,0
2006,36,DAL,K,13,10,0,,,7,6,6,5,4,1,1,1,18,13,72.2,33,33,100.0,,,,,,0
Career,,,,,135,0,6,6,79,76,74,67,85,66,22,15,266,230,86.5,379,377,99.5,1,29,29,0,29.0,0
8 yrs,,IND,,,125,0,6,6,72,70,68,62,81,65,21,14,248,217,87.5,346,344,99.4,1,29,29,0,29.0,0
1 yr,,DAL,,,10,0,,,7,6,6,5,4,1,1,1,18,13,72.2,33,33,100.0,,,,,,0"

con<-textConnection(lines)
mv<-read.csv(con)

dat<-data.frame(dist=c("all","under20","twenties","thirties","forties","over50"),
                att=c(266,6,79,74,85,22),      
                made=c(230,6,76,67,66,15))

dat$per<-dat$made/dat$att
dat$distprob<-dat$att/266

# Jason Hanson

lines2<-"Year,Age,Tm,Pos,No.,G,GS,FGA019,FGM019,FGA20229,FGM2029,FGA3039,FGM3039,FGA4049,FGM4049,FGA50,FGM50,FGAtot,FGMtot,FGper,XPA,XPM,XPper,Pnt,Yds,Lng,Blck,Y/P,AV
1992,22,DET,K,4,16,0,,,5,5,10,10,6,4,5,2,26,21,80.8,30,30,100.0,,,,,,0
1993,23,DET,K,4,16,0,1,1,8,8,15,15,12,7,7,3,43,34,79.1,28,28,100.0,,,,,,0
1994,24,DET,K,4,16,0,,,7,6,7,7,8,5,5,,27,18,66.7,40,39,97.5,,,,,,0
1995,25,DET,K,4,16,0,2,2,4,4,17,16,10,5,1,1,34,28,82.4,48,48,100.0,1,34,34,0,34.0,0
1996,26,DET,K,4,16,0,,,4,4,5,4,4,3,3,1,17,12,70.6,36,36,100.0,1,24,24,0,24.0,0
1997,27,DET,K,4,16,0,,,10,10,9,8,5,5,5,3,29,26,89.7,40,39,97.5,,,,,,0
1998,28,DET,K,4,16,0,,,8,8,7,7,15,13,3,1,33,29,87.9,29,27,93.1,3,94,36,0,31.3,0
1999,29,DET,K,4,16,0,,,8,8,4,4,12,10,8,4,32,26,81.3,29,28,96.6,,,,,,0
2000,30,DET,K,4,16,0,2,2,7,6,12,10,7,4,2,2,30,24,80.0,29,29,100.0,,,,,,0
2001,31,DET,K,4,16,0,1,1,2,2,8,8,12,6,7,4,30,21,70.0,23,23,100.0,,,,,,0
2002,32,DET,K,4,16,0,,,8,8,9,8,8,7,3,,28,23,82.1,31,31,100.0,,,,,,0
2003,33,DET,K,4,16,0,,,7,7,6,6,6,5,4,4,23,22,95.7,27,26,96.3,7,264,50,0,37.7,0
2004,34,DET,K,4,16,0,,,9,9,11,10,8,5,,,28,24,85.7,28,28,100.0,,,,,,0
2005,35,DET,K,4,15,0,1,1,9,9,3,3,7,4,4,2,24,19,79.2,27,27,100.0,,,,,,0
2006,36,DET,K,4,16,0,1,1,12,12,6,6,8,7,6,3,33,29,87.9,30,30,100.0,,,,,,0
2007,37,DET,K,4,16,0,1,1,5,4,12,10,13,11,4,3,35,29,82.9,36,35,97.2,,,,,,0
2008,38,DET,K,4,16,0,,,3,3,5,4,6,6,8,8,22,21,95.5,26,25,96.2,,,,,,0
2009,39,DET,K,4,16,0,,,,,,,,,,,28,21,75.0,25,25,100.0,,,,,,0
2010,40,DET,k,4,8,0,,,1,1,4,4,5,4,4,3,14,12,85.7,19,19,100.0,,,,,,0
2011,41,DET,k,4,16,0,,,9,9,9,8,4,2,7,5,29,24,82.8,54,54,100.0,,,,,,0
2012,42,DET,k,4,9,0,1,1,1,1,4,4,13,11,1,1,20,18,90.0,22,22,100.0,3,118,46,0,39.3,
Career,,,,,320,0,10,10,127,124,163,152,169,124,87,50,585,481,82.2,657,649,98.8,15,534,50,0,35.6,0"

con<-textConnection(lines2)
jh<-read.csv(con)


jhtot<-subset(jh,Year=="Career")

dat2<-data.frame(dist=c("all","under20","twenties","thirties","forties","over50"),
                att=c(585,10,127,163,169,87),      
                made=c(481,10,124,152,124,50))

dat2$per<-dat$made/dat$att
dat2$distprob<-dat$att/585



N <- 1:3
SE <- c(.272, .19, .16)
HI <- c(1.2, 1.0, .98)
LO <- c( .13, .29, .36)
AVG <- c(.667, .667, .667)
Shots <- c(1,0,1)
for (i in 5:50) {
  Shots[i] <- sample(c(1,0,1), 1)
  N[i] <- i
  SE[i] <- sqrt(mean(Shots)/N[i])
  HI[i] <- mean(Shots) + 1.96 * SE[i]
  LO[i] <- mean(Shots) - 1.96 * SE[i]
  AVG[i] <- mean(Shots)
}


qplot(N, AVG, ymin=LO, ymax=HI, geom="pointrange", colour=-AVG, size=I(.9)) +theme_bw() + scale_colour_gradientn(colours=c("red", "blue")
)      + geom_hline(y=.43)   +labs(title = "Your Recruit Over 50 Shots \n") + ylab("Pct 3pt Shot Made \n")

N <- 1:3
SE <- c(.272, .19, .16)
HI <- c(1.2, 1.0, .98)
LO <- c( .13, .29, .36)
AVG <- c(.667, .667, .667)
Shots <- c(1,0,1)

for (i in 4:500) {
  Shots[i] <- sample(c(1,0,1), 1)
  N[i] <- i
  SE[i] <- sqrt(mean(Shots)/N[i])
  HI[i] <- mean(Shots) + 1.96 * SE[i]
  LO[i] <- mean(Shots) - 1.96 * SE[i]
  AVG[i] <- mean(Shots)
}


qplot(N, AVG, ymin=LO, ymax=HI, geom="pointrange", colour=-AVG, alpha=.5, size=I(.9)) +theme_bw() + scale_colour_gradientn(colours=c("red", "blue")
)      + geom_hline(y=.43)   +labs(title = "Your Recruit Over 500 Shots \n") + ylab("Pct 3pt Shot Made \n")
